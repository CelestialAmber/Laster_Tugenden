<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>General Commands of the Goddess</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/navbar-bottom/">

    <!-- Bootstrap core CSS -->
<link href="css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

      <style>
    /* latin */
@font-face {
  font-family: 'Playfair Display';
  font-style: normal;
  font-weight: 400;
  src: local('Playfair Display Regular'), local('PlayfairDisplay-Regular'), url(nuFiD-vYSZviVYUb_rj3ij__anPXDTzYgEM86xQ.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* latin */
@font-face {
  font-family: 'UnifrakturMaguntia';
  font-style: normal;
  font-weight: 400;
  src: local('UnifrakturMaguntia'), url(WWXPlieVYwiGNomYU-ciRLRvEmK7oaVemGZMFABK1Q.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/*
    body {

      max-width: 600px;
      margin: auto;
      padding-top: 10px;
    }*/
    h1{
      text-align: center;
    }
    table {
        border-collapse: collapse;
    }
   /* table {
      border:none;
    }
    th, td {
      border: 1px solid black;
    }
    td {
      width:100pt;
      text-align: center;
    }*/
    .oben {
      border-top: none;
    }
    .obenleft {
      /*border-left: none;*/
    }
    .obenright {
      /*border-right: none;*/
    }
    #line {
      font-weight: bold;
      text-align: center;
      font-size: 150%;

    }
    #selected {
      font-weight: bold;
      text-align: center;
    }
    .virtue { 
      /*font-family: 'Playfair Display', serif;*/
      color:green;
    }
    .vices {
      /*font-family: 'UnifrakturMaguntia', cursive;*/
      color:red;
    }
    .draw {
      /*font-family: 'UnifrakturMaguntia', cursive;*/
      /*color:gray;*/
      /*alpha:0.5;*/
      /*background-color: lightgray;*/
      opacity: 0.5;
    }
    .side {
      width:30pt;
        border-left: none;
        border-right: none;
        text-align: center; 
    }
    .emside {
      width:30pt;
      border:none;
    }
    .status {
      height:50pt;
    }
    .good {
      background-color: lightgreen;
    }
    .evil {
      background-color: pink;
    }
    .goodbad {      
      height:50pt;
      border:none;
      font-weight: bold;
      font-size: 200%;
    }
    .invis {
      border:none;
    }
    #score {
      text-align: left;
      border:none;
      font-weight: none;
    }
    button {      
      /*border:none;*/
      font-weight: bold;
      font-size: 100%;
      /*width: 100%;*/
    }
    #goodbutton {
      /*background-color: lightgreen;*/
    }
    #badbutton {
      /*background-color: pink;*/
    }
    .table-condensed>thead>tr>th, .table-condensed>tbody>tr>th, .table-condensed>tfoot>tr>th, .table-condensed>thead>tr>td, .table-condensed>tbody>tr>td, .table-condensed>tfoot>tr>td{
    padding: 5px;
}
  </style>

  </head>
  <body>
<main role="main" class="flex-shrink-0">
  <div class="container">

    <h1>General Commandments of the Goddess</h1>
  <p>

<table class="table table-condensed table-bordered" id="maintable">
    <tr>
    <td class="emside">
    </td>
    <td class="goodbad" colspan="2">
      <a href="#" class="btn btn-lg btn-success btn-block" href="/docs/4.3/components/navbar/" role="button"  id="goodbutton"  accesskey="s">Thou shalt </a>
    </td>
    <td class="goodbad"  colspan="2">
      <a href="#"  class="btn btn-lg btn-danger btn-block" href="/docs/4.3/components/navbar/" role="button"  id="badbutton"  accesskey="n">Thou shalt <u>not</u></a>
    </td>
    <td class="emside">
    </td>
  </tr>
    <tr>
    <td class="emside">
    </td>
    <td id="score">
      Score:10
    </td>
    <td class="invis">
    </td>
    <td class="invis">
    </td>
    <td class="invis">
    </td>
    <td class="emside">
    </td>
  </tr>

  <tr class="oben">
    <td class="emside">
    </td>
    <td id="r1c1" class="oben obenleft">⋮
    </td>
    <td id="r1c4" class="oben">⋮
    </td>
    <td id="r1c4" class="oben">⋮
    </td>
    <td id="r1c4" class="oben obenright">⋮
    </td>
    <td class="emside">
    </td>
  </tr>

</table>
</p>
<p>
  <a class="btn btn-primary" href="/docs/4.3/components/navbar/" role="button" id="newgamebutton" >Spiel neustarten</a>


  </div>
</div>
</p></div>
</p>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
     <script src="js/bootstrap.bundle.min.js" integrity="sha384-xrRywqdh3PHs8keKZN+8zzc5TX0GRTLCcmivcbNJWm2rs5C8PRhcEn3czEjhAO9o" crossorigin="anonymous"></script>



<script type="text/javascript">
  var state=[];

  var agent_num = 4;
  var command_num = 14;
  var front_line_num = 2;

  var emoji = ['🧜‍♂️','🦸‍♀️','🧛‍♂️','🧝‍♀️'];
  var starthealth=3;


  var goodButton;
  var badButton;
  var newGameButton;


  // var virtues = [
  // // 'Demut','Mildtätigkeit','Keuschheit','Geduld','Mäßigung','Wohlwollen','Fleiß'
  // // 'humilitas','caritas','castitas','patientia','temperantia','humanitas','industria'
  // ];
  // var vices = [
  // // 'Hochmut','Habgier','Wollust','Zorn','Völlerei','Neid','Faulheit'
  // ];

  var virtues = ['Chastity','Temperance','Charity','Diligence','Patience','Kindness','Humility'];

  var vices = ['Murder','Apostasy','Bestiality','Theft','Sodomy','Witchcraft','Rebellion'];
  var words = virtues.concat(vices);
  
  function isVirtuous(w){
    return virtues.indexOf(w)>=0;
  }

  function getWord(){
    return words[Math.floor(Math.random()*words.length)];
  }

  function commandValue(agent,word){
    // return (word.length%3)-1;

    for (var i=0;i<command_num;i++){
      var commandment = state.commandments[agent][i];
      if (commandment.length===0){
        continue;
      }
      if (commandment[1]===0){
        continue;
      }
      if (commandment[0]==word){
        return commandment[1];
      }
    }
    return 0;
  }

  function setState(){

    for (var i=0;i<agent_num;i++){
      var elem = document.getElementById('health'+i);
      elem.innerHTML=emoji[i]+" "+ state.healths[i];
    }

    for (var i=0;i<agent_num;i++){
      for (var j=0;j<front_line_num;j++){
        var elem = document.getElementById(`v${j}c${i}`);
        console.log(i,j);
        var word = state.front[i][j];
        elem.innerHTML=euphemism(word,i);

        var commandValueVar = commandValue(i,word);
        switch(commandValueVar){
          case -1:
          elem.className="evil";
          break;
          case 0:
          elem.className="";
          break;
          case 1:
          elem.className="good";
          break;
        }
      }
    }

    for (var i=0;i<agent_num;i++){
      for (var j=0;j<command_num;j++){
        var elem = document.getElementById(`g${j}c${i}`);
        console.log(i,j);
        var commandment = state.commandments[i][j];
        if (commandment.length===0){
          elem.innerHTML="&nbsp;";
          elem.className="";
          continue;
        }
        var commandValueVar = commandValue(i,commandment[0]);
        switch(commandValueVar){
          case -1:
          elem.className="evil";
          break;
          case 0:
          elem.className="draw";
          break;
          case 1:
          elem.className="good";
          break;
        }
        elem.innerHTML=euphemism(commandment[0],-1);
      }
    }

    // state.commandments=[];
    // for (var i=0;i<agent_num;i++){
    //  state.commandments.push([]);
    //  for (var j=0;j<command_num;j++){
    //    state.commandments[i].push(getWord());
    //  }
    // }

    // state.line=[];
    for (var i=0;i<agent_num;i++){
      var elem = document.getElementById(`agw${i}`);
      var word = state.line[i];
      elem.innerHTML=euphemism(word,i);


        var commandValueVar = commandValue(i,word);
        switch(commandValueVar){
          case -1:
          elem.className="evil";
          break;
          case 0:
          elem.className="";
          break;
          case 1:
          elem.className="good";
          break;
        }

    //  state.line.push(getWord());
    }
  }

  function generateTable(){

    var table = document.getElementById('maintable');

    state={};
    state.healths=[];
    for (var i=0;i<agent_num;i++){
      state.healths.push(starthealth);
    }

    state.front=[];
    for (var i=0;i<agent_num;i++){
      state.front.push([]);
      for (var j=0;j<command_num;j++){
        state.front[i].push(getWord());
      }
    }

    state.commandments=[];
    for (var i=0;i<agent_num;i++){
      state.commandments.push([]);
      for (var j=0;j<command_num;j++){
        state.commandments[i].push([words[j],0]);
      }
    }

    state.line=[];
    for (var i=0;i<agent_num;i++){
      state.line.push(getWord());
    }

    var inner = "";

    for (var i=0;i<front_line_num;i++){
      inner += `
  <tr>
    <td class="emside">
    </td>`

      for (var j=0;j<agent_num;j++){
        inner +=`<td id="v${i}c${j}">
      platzhalter
    </td>`
      }

      inner +=`
    <td class="emside">
    </td>
  </tr>`

    }

    inner+= `
  <tr id="selected">
    <td class="side">
      ->
    </td>`


      for (var j=0;j<agent_num;j++){
        inner +=`<td id="agw${j}">
      platzhalter
    </td>`
      }

    inner+=`
    <td class="side">
      &lt;-
    </td>
  </tr>`

    inner+=`
  <tr class="status" id ="line">
    <td class="emside">
    </td>`


      for (var j=0;j<agent_num;j++){
        inner +=`
    <td id="health${j}">
      666
    </td>`
      }


    inner+=`
    <td class="emside">
    </td>
  </tr>`


    for (var i=0;i<command_num;i++){
      inner += `
  <tr>
    <td class="emside">
    </td>`

      for (var j=0;j<agent_num;j++){
        inner +=`<td id="g${i}c${j}">
      platzhalter
    </td>`
      }

      inner +=`
    <td class="emside">
    </td>
  </tr>`

    }
    table.innerHTML +=  inner;
  }

  function shouldAnimate(){   
    for (var i=0;i<agent_num;i++){
      var word = state.line[i];
      if (commandValue(i,word)!=0){
        return true;
      }
    }
  }

  function tueTick(){
    for (var i=0;i<agent_num;i++){
      var word = state.line[i];
      if (commandValue(i,word)!=0){
        var commandValueVar = commandValue(i,word);
        commandColumn(i,commandValueVar,false);
      }
    }
    setState();

    if (shouldAnimate()){
      startAnimation();
    } else {
      goodButton.disabled=false;
      badButton.disabled=false;
      newGameButton.disabled=false;
    }
  }

  function startAnimation(){
    goodButton.disabled=true;
    badButton.disabled=true;
    newGameButton.disabled=true;

    setTimeout(tueTick,100);
  }

  function commandment(commandValueVar){
    for (var i=0;i<agent_num;i++){
      commandColumn(i,commandValueVar,true);
    }
    
    if (shouldAnimate()){
      startAnimation();
    }

    setState();
  }

  function commandColumn(agent,commandValueVar,add){
    var i=agent;
    //1 move down commandments

    // if (add){
    //  for (var j=command_num-1;j>=0;j--){
    //    state.commandments[i][j+1]=state.commandments[i][j];
    //  }
    // }

    //2 move the active row down + set commandValueVar

    var commandmentLine = words.indexOf(state.line[i]);
    if (add){
      state.commandments[i][commandmentLine][1]=commandValueVar;
    }

      var delta=0;
      if (isVirtuous(state.line[i])){
        delta=commandValueVar;
      } else {
        delta=-commandValueVar;
      }

      {
        var word =  state.line[i];

        //for every other character
        for (var o=0;o<agent_num;o++){
          if (o===agent){
            continue;
          }

          var virtue = isVirtuous(word);
          var o_does = commandValue(o,word);
          
           // if you fail to do something good that they value, they will punish you
          if (commandValueVar==-1 && virtue===true && o_does===1){
            delta-=1;
          }

          //if you do something evil that they are not allowed to do, they will punish you
          if (commandValueVar==1 && virtue===false && o_does===-1){
            delta-=1;
          }
        }
        state.healths[i]+=delta;
      }

    //3 move down the preview line

      state.line[i]=state.front[i][front_line_num-1];


    //4 move preview line down

      for (var j=front_line_num-1;j>=0;j--){
        state.front[i][j+1]=state.front[i][j];
      }

    //5 draw again

      state.front[i][0]=getWord();


    //6 start animation if relevant
  }

  function clickOnGood(){
    commandment(1);
  }
  
  function clickOnBad(){
    commandment(-1);
  }
  
  function clickOnNew(){
    generateTable();
    setState();
  }

  function euphemism(w,agent){
    var virtue = isVirtuous(w);

    if (agent>=0){
      var delta=0;

      for (var o=0;o<agent_num;o++){
        if (o===agent){
          continue;
        }

        var o_does = commandValue(o,w);
        
         // if you fail to do something good that they value, they will punish you
        if (virtue===true && o_does===1){
          delta++;
        }

        //if you do something evil that they are not allowed to do, they will punish you
        if (virtue===false && o_does===-1){
          delta++;
        }
      }
      if (delta!=0){
        w+='<sup>';
        for (var i=0;i<delta;i++){
          w+='†';
        }
        w+='</sup>';
      }
    }
    if (virtue){
      w = `<span class="virtue">${w}</span>`;
    } else {
      w = `<span class="vices">${w}</span>`;
    } 

    return w; 
  }

  function closeButtons(){

    goodButton = document.getElementById('goodbutton');
    badButton = document.getElementById('badbutton');
    newGameButton = document.getElementById('newgamebutton');

    goodButton.addEventListener("click", clickOnGood);
    badButton.addEventListener("click", clickOnBad);
    newGameButton.addEventListener("click", clickOnNew);

  }

  generateTable();
  setState();
  closeButtons();

</script>

   </body>
</html>

